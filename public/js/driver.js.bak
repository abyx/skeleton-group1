myModule.service('myDriverService', function($http) {
    
    this.getOptions = function() {
        return $http({
            "method": "post",
            "url": 'http://localhost:3000/getDriver', 
            "data": {
                options: []
            }
        });
    };
});

angular.module('app').controller('getDriver', function($scope, myDriverService, init, DriverRepository) {
    var self = this;
   
   	console.log("in driver. controller  BEGAIN.");
    function initController() {
          $scope.selectedOption = null;
          $scope.options = [];
          $scope.logentries = [];
        init('getDriver', [myDriverService.getOptions()], function(result) {
        console.log("driver is " ,  result);
        $scope.options = result[0].data.driver;

        this.passenger = result[0].data.driver;
        $scope.selectedOption = 0;
    });
    
    
    $scope.$on('appInitialized', function () {
        console.log("appInitialized - selection: " + $scope.selectedOption);
        $scope.logentries.push(($scope.logentries.length + 1) + " - appInitialized - selection: " + $scope.selectedOption);
    });
   } 
   
  self.post = function(DriverRepository, driverList)
	{				
		console.log("in driver.post BEGAIN. DriverRepository= " + DriverRepository + ", driverList= " + driverList);
		 
		  DriverRepository.post(self.driverList).then(
				function(result)
				{
					if(result != null && result != "undefined")
					{
						if(result.status == true)
						{
							console.log("in driver.post. in success handler scope. result is true");
						}
					}
				},
				function(result)
				{
					if(result != null && result != "undefined")
					{
						console.log("in driver.post. in error handler scope");
					}
				}
			)
			.catch(function(result)
			{
				console.log("in driver.post. in catch handler scope");
			});
	}
	
	  self.buttonClicked = function()
		{
			 DriverRepository.post([self.driver]);
		}
   
    initController();
	
});

angular.module('app.Repositories').factory('DriverRepository', function($http) {
	  return {
        post: function(driverList) {
            $http.post('http://localhost:3000/DriverRequest',	driverList).then(	
   						function(response)	
   						{	
   							  console.log('in DriverRepository.post. got response=',	response.data);
   								alert ('finished');
   						},
   						function(response)
   						{
   							console.log('in DriverRepository.post. got response=',	response.data);
   								alert ('Error');
   						}   						
			);
        }
    };

}); 